<?xml version="1.0" encoding="UTF-8"?>
<applications xmlns="http://www.wabacus.com"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://www.wabacus.com ../xsd/wabacus.applications.xsd">
<page id="t_exam_site_list">
  <report id="report1"  extends="basePage.editList2" title="考场管理">
    <display>
      <col column="{sequence:1}" label="序号" />
      <col column="id" displaytype="hidden"/>
        <col column="code" label="代码"/>
      <col column="name" label="名称"/>
      <col column="remark" label="备注"/>
    </display>
    <sql>
      <select>
      <value><![CDATA[      select * from t_exam_site       ]]></value>
      </select>
      <insert>
      <![CDATA[
      insert into t_exam_site(id=sequence{seq_t_exam_site},
@{name},@{remark},@{code})
      ]]>
      </insert>
      <update>
      <![CDATA[
      update t_exam_site(@{name},@{remark},@{code})
      where id=@{id}
      ]]>
      </update>
      <delete><![CDATA[delete from t_exam_site where id=@{id}]]></delete>
    </sql>
  </report>
</page>

 <!--考场考生情况表-->
<page id="t_exam_site_stu_list">    
    <report id="report1" type="list"
            dataexport="richexcel"  title="考场考生情况表">
        <dataexports>
            <dataexport  type="richexcel" filename="考场考生情况表"  template="relative{/template/dataexport/site_stu.html}"></dataexport>
        </dataexports>
        <interceptor>
            <imports>
                <import>com.ggs.dao.DataDao</import>
                <import>com.ggs.util.DateUtil</import>
            </imports>
            <preaction>
                String siteid=rrequest.getStringAttribute("siteid","");
                String addrid=rrequest.getStringAttribute("addrid","");
                String site_name=DataDao.getExamSiteName(siteid);
                String addr_name=DataDao.getExamAddrName(addrid);
                String cur_year=DateUtil.getDatebyFormat("yyyy");
                rrequest.getRequest().setAttribute("site_name",site_name);
                rrequest.getRequest().setAttribute("addr_name",addr_name);
                rrequest.getRequest().setAttribute("cur_year",cur_year);
            </preaction>
        </interceptor>
        <display>
            <col column="{sequence:1}" label="序号" width="40" />
<!--
            <col column="site_name" label="考场"/>
            <col column="addr_name" label="考点"/>
-->
            <col column="name" label="姓名"/>
            <col column="sex" label="性别"/>
            <col column="test_no" label="准考证号" valuestyleproperty="style='mso-number-format:\@' "/>
            <col column="idcard" label="身份证号" valuestyleproperty="style='mso-number-format:\@' "/>
            <col column="test_level_name" label="报考级别"/>
            <col column="tech_name_name" label="报考资格"/>
            <col column="spec_class_name" label="专业"/>
            <col column="photo" label="照片"/>
        </display>
        <sql>
            <select>
                <value>
                    <![CDATA[
                            select * from v_exam_site_stu where {#condition#}
                            ]]>
                </value>
                <condition name="siteid" label="考场" labelposition="left">
                    <inputbox type="selectbox">
                        <option source="@{select * from t_exam_site}" label="name" value="id"></option>
                    </inputbox>
                    <value><![CDATA[siteid=#data# ]]></value>
                </condition>
                <condition name="addrid" label="考点" labelposition="left">
                    <inputbox type="selectbox"  depends="siteid">
                        <option value="" label="全部"></option>
                        <option source="@{select * from t_exam_addr where siteid=#siteid#}" label="name" value="id"></option>
                    </inputbox>
                    <value><![CDATA[addrid=#data# ]]></value>
                </condition>
                <condition name="name" label="姓名" labelposition="left">
                    <value><![CDATA[name like '%#data#%' ]]></value>
                </condition>
            </select>
        </sql>
        <format>
            <value>
                <![CDATA[
                        photo="<img src='"+photo+"' width='100px' height='120px'>";
                        ]]>
            </value>
        </format>
    </report>    
</page>

</applications>
